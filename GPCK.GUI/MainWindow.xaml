<Window x:Class="GPCKGUI.MainWindow" xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation" xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml" Title="GPCK Asset Browser" Height="768" Width="1280" WindowStartupLocation="CenterScreen" Background="#F3F3F3">
	<Grid>
		<Grid.RowDefinitions>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="Auto"/>
			<RowDefinition Height="*"/>
			<RowDefinition Height="Auto"/>
		</Grid.RowDefinitions>
		<!-- Header -->
		<Border Grid.Row="0" Background="#FFFFFF" BorderBrush="#E0E0E0" BorderThickness="0,0,0,1" Padding="20,15">
			<DockPanel>
				<StackPanel DockPanel.Dock="Right" Orientation="Horizontal" VerticalAlignment="Center">
					<TextBlock x:Name="TxtBackendStatus" Text="System Check..." Foreground="#999" FontSize="12" VerticalAlignment="Center" Margin="0,0,10,0"/>
				</StackPanel>
				<StackPanel>
					<TextBlock Text="GPCK Asset Browser" FontSize="20" FontWeight="SemiBold" Foreground="#333"/>
					<TextBlock Text="Next-Gen Asset Management System (.NET 10)" FontSize="12" Foreground="#888" Margin="0,2,0,0"/>
				</StackPanel>
			</DockPanel>
		</Border>
		<!-- Toolbar -->
		<Border Grid.Row="1" Background="#FFFFFF" Padding="10,10" Margin="0,0,0,1">
			<WrapPanel>
				<Button x:Name="BtnOpenArchive" Content="ðŸ“‚ Open Archive" Style="{StaticResource ModernBtn}" Margin="0,0,10,0" Click="BtnOpenArchive_Click"/>
				<Rectangle Width="1" Height="24" Fill="#EEE" Margin="5,0,15,0" VerticalAlignment="Center"/>
				<Button x:Name="BtnAddFiles" Content="+ Add Files" Style="{StaticResource ModernBtn}" Margin="0,0,10,0" Click="BtnAddFiles_Click"/>
				<Button x:Name="BtnAddFolder" Content="+ Add Folder" Style="{StaticResource ModernBtn}" Margin="0,0,10,0" Click="BtnAddFolder_Click"/>
				<Button x:Name="BtnClear" Content="Clear List" Style="{StaticResource DangerBtn}" Margin="0,0,10,0" Click="BtnClear_Click"/>
				<Rectangle Width="1" Height="24" Fill="#EEE" Margin="5,0,15,0" VerticalAlignment="Center"/>
				<Button x:Name="BtnExtractAll" Content="Extract All" Style="{StaticResource ModernBtn}" Margin="0,0,10,0" Click="BtnExtractAll_Click"/>
                <ComboBox x:Name="CmbMethod" Width="100" Margin="0,0,10,0" VerticalContentAlignment="Center" SelectedIndex="0">
                    <ComboBoxItem Content="Auto"/>
                    <ComboBoxItem Content="Zstd"/>
                    <ComboBoxItem Content="LZ4"/>
                    <ComboBoxItem Content="GDeflate"/>
                    <ComboBoxItem Content="Store"/>
                </ComboBox>
				<Button x:Name="BtnCompress" Content="ðŸš€ Pack .gpck" Style="{StaticResource PrimaryBtn}" Click="BtnCompress_Click"/>
			</WrapPanel>
		</Border>
		<!-- Main Content Area -->
		<TabControl Grid.Row="2" Margin="10" BorderThickness="0" Background="Transparent">
			<TabControl.Resources>
				<Style TargetType="TabItem">
					<Setter Property="Template">
						<Setter.Value>
							<ControlTemplate TargetType="TabItem">
								<Border Name="Border" BorderThickness="0,0,0,2" BorderBrush="Transparent" Margin="0,0,20,0" Padding="10,5">
									<ContentPresenter x:Name="ContentSite" VerticalAlignment="Center" HorizontalAlignment="Center" ContentSource="Header" Margin="0,2"/>
								</Border>
								<ControlTemplate.Triggers>
									<Trigger Property="IsSelected" Value="True">
										<Setter TargetName="Border" Property="BorderBrush" Value="#007ACC"/>
										<Setter Property="Foreground" Value="#007ACC"/>
										<Setter Property="FontWeight" Value="SemiBold"/>
									</Trigger>
									<Trigger Property="IsSelected" Value="False">
										<Setter Property="Foreground" Value="#666"/>
									</Trigger>
								</ControlTemplate.Triggers>
							</ControlTemplate>
						</Setter.Value>
					</Setter>
				</Style>
			</TabControl.Resources>

			<!-- TAB 1: EXPLORER -->
			<TabItem Header="Explorer">
				<Grid Margin="0,10,0,0">
					<Grid.ColumnDefinitions>
						<ColumnDefinition Width="2*"/>
						<ColumnDefinition Width="5"/>
						<ColumnDefinition Width="1*"/>
					</Grid.ColumnDefinitions>
					<!-- File List -->
					<Grid Grid.Column="0">
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="*"/>
						</Grid.RowDefinitions>
						<TextBlock Text="Package Contents" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="#555"/>
						<Border Grid.Row="1" Background="White" BorderBrush="#DDD" BorderThickness="1" CornerRadius="4">
							<ListView x:Name="FileList" BorderThickness="0" AllowDrop="True" Drop="FileList_Drop" SelectionChanged="FileList_SelectionChanged" AlternationCount="2">
								<ListView.ItemContainerStyle>
									<Style TargetType="ListViewItem">
										<Setter Property="HorizontalContentAlignment" Value="Stretch"/>
										<Style.Triggers>
											<Trigger Property="ItemsControl.AlternationIndex" Value="0">
												<Setter Property="Background" Value="#FFFFFF"/>
											</Trigger>
											<Trigger Property="ItemsControl.AlternationIndex" Value="1">
												<Setter Property="Background" Value="#FAFAFA"/>
											</Trigger>
											<Trigger Property="IsSelected" Value="True">
												<Setter Property="Background" Value="#E5F3FB"/>
												<Setter Property="BorderBrush" Value="#D9EBf9"/>
											</Trigger>
										</Style.Triggers>
									</Style>
								</ListView.ItemContainerStyle>
								<ListView.View>
									<GridView>
										<GridViewColumn Header="" DisplayMemberBinding="{Binding TypeIcon}" Width="35"/>
										<GridViewColumn Header="Path" DisplayMemberBinding="{Binding DisplayName}" Width="350"/>
										<GridViewColumn Header="Size" DisplayMemberBinding="{Binding Size}" Width="80"/>
										<GridViewColumn Header="Method" DisplayMemberBinding="{Binding CompressionInfo}" Width="120"/>
										<GridViewColumn Header="Manifest" DisplayMemberBinding="{Binding ManifestInfo}" Width="150"/>
									</GridView>
								</ListView.View>
							</ListView>
						</Border>
					</Grid>
					<!-- Splitter -->
					<GridSplitter Grid.Column="1" Width="5" HorizontalAlignment="Center" Background="Transparent"/>
					<!-- Preview -->
					<Grid Grid.Column="2">
						<Grid.RowDefinitions>
							<RowDefinition Height="Auto"/>
							<RowDefinition Height="*"/>
						</Grid.RowDefinitions>
						<TextBlock Text="Inspector" FontWeight="SemiBold" Margin="0,0,0,8" Foreground="#555"/>
						<Border Grid.Row="1" Background="#1E1E1E" BorderBrush="#333" BorderThickness="1" CornerRadius="4" ClipToBounds="True">
							<Grid>
								<TextBlock x:Name="LblNoPreview" Text="Select an asset to preview" Foreground="#666" VerticalAlignment="Center" HorizontalAlignment="Center" FontStyle="Italic"/>
								<Image x:Name="ImgPreview" Visibility="Collapsed" Stretch="Uniform" RenderOptions.BitmapScalingMode="NearestNeighbor"/>
								<TextBox x:Name="TxtPreview" Visibility="Collapsed" IsReadOnly="True" Background="Transparent" Foreground="#D4D4D4" BorderThickness="0" FontFamily="Consolas" FontSize="12" Padding="10" VerticalScrollBarVisibility="Auto" TextWrapping="Wrap"/>
								<TextBox x:Name="HexPreview" Visibility="Collapsed" IsReadOnly="True" Background="Transparent" Foreground="#569CD6" BorderThickness="0" FontFamily="Consolas" FontSize="12" Padding="10" VerticalScrollBarVisibility="Auto"/>
							</Grid>
						</Border>
					</Grid>
				</Grid>
			</TabItem>

			<!-- TAB 2: VISUALIZER -->
			<TabItem Header="Map Visualizer">
				<Grid Margin="0,10,0,0">
					<Grid.RowDefinitions>
						<RowDefinition Height="Auto"/>
						<RowDefinition Height="*"/>
					</Grid.RowDefinitions>
					<StackPanel Orientation="Horizontal" Margin="0,0,0,10">
						<TextBlock Text="Archive Fragmentation Map" FontWeight="SemiBold" Foreground="#555" VerticalAlignment="Center"/>
						<Border Background="#90EE90" Width="12" Height="12" Margin="20,0,5,0" CornerRadius="2"/>
						<TextBlock Text="GDeflate" FontSize="11" VerticalAlignment="Center"/>
						<Border Background="#ADD8E6" Width="12" Height="12" Margin="15,0,5,0" CornerRadius="2"/>
						<TextBlock Text="Zstd" FontSize="11" VerticalAlignment="Center"/>
                        <Border Background="#FFD580" Width="12" Height="12" Margin="15,0,5,0" CornerRadius="2"/>
                        <TextBlock Text="LZ4" FontSize="11" VerticalAlignment="Center"/>
						<Border Background="#D3D3D3" Width="12" Height="12" Margin="15,0,5,0" CornerRadius="2"/>
						<TextBlock Text="Uncompressed" FontSize="11" VerticalAlignment="Center"/>
					</StackPanel>
					
					<Border Grid.Row="1" Background="#2D2D30" BorderBrush="#444" BorderThickness="1" CornerRadius="4" Padding="10">
						<ScrollViewer VerticalScrollBarVisibility="Auto">
							<ItemsControl x:Name="VisualizerItems">
								<ItemsControl.ItemsPanel>
									<ItemsPanelTemplate>
										<WrapPanel Orientation="Horizontal" Width="1180"/>
									</ItemsPanelTemplate>
								</ItemsControl.ItemsPanel>
								<ItemsControl.ItemTemplate>
									<DataTemplate>
										<Rectangle Width="{Binding Width}" Height="24" Fill="{Binding Color}" ToolTip="{Binding ToolTip}" Margin="0,1,1,0"/>
									</DataTemplate>
								</ItemsControl.ItemTemplate>
							</ItemsControl>
						</ScrollViewer>
					</Border>
				</Grid>
			</TabItem>
		</TabControl>

		<!-- Status Bar -->
		<Grid Grid.Row="3" Background="#007ACC" Height="28">
			<TextBlock x:Name="TxtStatus" Text="Ready" Foreground="White" VerticalAlignment="Center" Margin="10,0" FontSize="12"/>
			<ProgressBar x:Name="ProgressBar" HorizontalAlignment="Right" Width="200" Height="12" Margin="10,0" Visibility="Hidden" Background="#005A9E" BorderThickness="0" Foreground="White"/>
		</Grid>
	</Grid>
</Window>